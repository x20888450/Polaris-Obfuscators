name: upload

on:
  workflow_dispatch:
    inputs:
      release:
        description: '是否发布新版本'
        required: false
        default: 'false'
      version:
        description: '发布版本号'
        required: false
        default: 'v1.0'

jobs:
  download-and-upload:
    runs-on: ubuntu-latest

    steps:
      # 下载目标文件
      - name: Download Artifact
        run: |
          curl -L -o Polaris-Obfuscators.zip "https://github.com/x20888450/Polaris-Obfuscators/actions/runs/12135866683/artifacts/2266363106"
          #unzip artifact.zip -d artifact_content

      # 发布 Release
      - name: Upload Release
        if: github.event.inputs.release == 'true' && success() && !cancelled()
        uses: ncipollo/release-action@v1.14.0
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          name: ${{ github.event.inputs.version }}
          tag: ${{ github.event.inputs.version }}
          body: 这是通过 GitHub Actions 自动发布的版本。
          artifacts: "Polaris-Obfuscators.zip"
          allowUpdates: true
          makeLatest: true
          omitBodyDuringUpdate: true
          replacesArtifacts: true
